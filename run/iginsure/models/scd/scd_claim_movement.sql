create view "dbt_szammit"."scd_claim_movement__dbt_tmp" as
    -- This file is automatically generated

with

claim_movement as (
    select * from "IGI_PROD_DW"."dbo"."ClaimMovement"
),

ordered as (
    select
        lClaimMovementKey,
        lClaimSectionKey,
        lClaimKey,
        lAccountPeriodKey,
        lAccountPeriodOriginalKey,
        dtMovementFirstAdvised,
        dtMovementCreated,
        dtMovementUpdated,
        sMovementReference,
        nSequence,
        nBureauSequence,
        bManualMovement,
        bConverted,
        sPaymentReference,
        lTransactionTypeKey,
        lPayeeContactKey,
        lPayeeRoleKey,
        bReserveTBA,
        lTypeOfReserveQualifierKey,
        lTypeOfMovementKey,
        lPayMethodKey,
        lPayCcyOrigKey,
        dPayROEOrig,
        lPayCcySettKey,
        dPayROESett,
        lPayCcyReportKey,
        dPayROEReport,
        dPaidThisTimeOrig100,
        dPaidThisTimeOrigShare,
        dPaidThisTimeSett100,
        dPaidThisTimeSettShare,
        dPaymentOrig100,
        dPaymentOrigShare,
        dPaymentSett100,
        dPaymentSettShare,
        dPaymentAuthorisedOrig100,
        dPaymentAuthorisedOrigShare,
        dPaymentAuthorisedSett100,
        dPaymentAuthorisedSettShare,
        dPaymentPendingBureauOrig100,
        dPaymentPendingBureauOrigShare,
        dPaymentPendingBureauSett100,
        dPaymentPendingBureauSettShare,
        dPaymentPendingManualOrig100,
        dPaymentPendingManualOrigShare,
        dPaymentPendingManualSett100,
        dPaymentPendingManualSettShare,
        dFacRIPaidThisTimeOrigShare,
        dFacRIPaidThisTimeSettShare,
        dPropRIPaidThisTimeOrigShare,
        dPropRIPaidThisTimeSettShare,
        dXLRIPaidThisTimeOrigShare,
        dXLRIPaidThisTimeSettShare,
        dPaidToDateBureauOrig100,
        dPaidToDateBureauOrigShare,
        dPaidToDateBureauSett100,
        dPaidToDateBureauSettShare,
        dPaidToDateSettShareHold,
        dFacRIPaidToDateOrigShare,
        dFacRIPaidToDateSettShare,
        dPropRIPaidToDateOrigShare,
        dPropRIPaidToDateSettShare,
        dXLRIPaidToDateOrigShare,
        dXLRIPaidToDateSettShare,
        dNetPaidToDateOrigShare,
        dNetPaidToDateSettShare,
        lReserveCcyOrigKey,
        dReserveROEOrig,
        lReserveCcySettKey,
        dReserveROESett,
        lReserveCcyReportKey,
        dReserveROEReport,
        dReserveOrig100,
        dReserveOrigShare,
        dReserveSett100,
        dReserveSettShare,
        dReserveChangeOrig100,
        dReserveChangeOrigShare,
        dReserveChangeSett100,
        dReserveChangeSettShare,
        dReserveChangeAuthOrig100,
        dReserveChangeAuthOrigShare,
        dReserveChangeAuthSett100,
        dReserveChangeAuthSettShare,
        dFacRIReserveOrigShare,
        dFacRIReserveSettShare,
        dPropRIReserveOrigShare,
        dPropRIReserveSettShare,
        dXLRIReserveOrigShare,
        dXLRIReserveSettShare,
        dNetReserveOrigShare,
        dNetReserveSettShare,
        lAdditionalReserveCcyOrigKey,
        dAdditionalReserveROEOrig,
        lAdditionalReserveCcySettKey,
        dAdditionalReserveROESett,
        lAdditionalReserveCcyReportKey,
        dAdditionalReserveROEReport,
        dAdditionalReserveOrig100,
        dAdditionalReserveOrigShare,
        dAdditionalReserveSett100,
        dAdditionalReserveSettShare,
        dAdditionalFacRIOrigShare,
        dAdditionalFacRISettShare,
        dAdditionalPropRIOrigShare,
        dAdditionalPropRISettShare,
        dAdditionalXLRIOrigShare,
        dAdditionalXLRISettShare,
        dAdditionalNetReserveOrigShare,
        dAdditionalNetReserveSettShare,
        dReviseReserveOrig100,
        dReviseReserveOrigShare,
        dReviseReserveSett100,
        dReviseReserveSettShare,
        dTotalReserveOrig100,
        dTotalReserveOrigShare,
        dTotalReserveSett100,
        dTotalReserveSettShare,
        dTotalFacRIReserveOrigShare,
        dTotalFacRIReserveSettShare,
        dTotalPropRIReserveOrigShare,
        dTotalPropRIReserveSettShare,
        dTotalXLRIReserveOrigShare,
        dTotalXLRIReserveSettShare,
        dTotalNetReserveOrigShare,
        dTotalNetReserveSettShare,
        dHighestEstimateOrig100,
        dLeadUWHighestEstimateOrig100,
        sMovementNarrative,
        lExternalAdjusterContactKey,
        sExternalAdjusterReference,
        lExternalLawyerContactKey,
        sExternalLawyerReference,
        sClaimMovementCreatedBy,
        nAccidentYear,
        lAuthorityCheckJoinKey,
        lEventKey,
        bGenerateClaimException,
        lClaimantContactKey,
        sInvoiceNumber,
        lClaimMovementIndemnityKey,
        lClassKey,
        lTypeOfSubClassKey,
        lPayeeRoleKey2,
        lPayeeContactKey2,
        dRIRecoverySettShare,
        dOutstandingRIRecoverySettShr,
        dDeductibleSettShare,
        dLOCAmountSettShare,
        lInsuredKey,
        lExternalAttorneyContactKey,
        lISODeductibleSizeKey,
        lISOTexasDeductibleKey,
        sExtraPaymentDetails,
        bMultiplePayee,
        lBordereauMonthKey,
        bInError,
        sAddressedToName,
        sAddressTo1,
        sAddressTo2,
        sAddressToCity,
        sAddressToPostalCode,
        lAddressToStateKey,
        lAddressedToCountryKey,
        dCurrentAddReserveSettShare,
        dCalcAddReserveSettShare,
        dAddReserveChangeSettShare,
        dReviseAddReserveSettShare,
        dNetPaymentOrigShare,
        dNetPaymentSettShare,
        dPaidToDateOrig100,
        dPaidToDateOrigShare,
        dPaidToDateSett100,
        dPaidToDateSettShare,
        dPaidToDateManualOrig100,
        dPaidToDateManualOrigShare,
        dPaidToDateManualSett100,
        dPaidToDateManualSettShare,
        dAddReserveChangeOrig100,
        dAddReserveChangeOrigShare,
        dAddReserveChangeSett100,
        dTotalReserveChangeOrig100,
        dTotalReserveChangeOrigShare,
        dTotalReserveChangeSett100,
        dTotalReserveChangeSettShare,
        dAddResChangeAuthOrig100,
        dAddResChangeAuthOrigShare,
        dAddResChangeAuthSett100,
        dAddResChangeAuthSettShare,
        dTotalResChangeAuthOrig100,
        dTotalResChangeAuthOrigShare,
        dTotalResChangeAuthSett100,
        dTotalResChangeAuthSettShare,
        dCurrentAddReserveOrig100,
        dCurrentAddReserveOrigShare,
        dCurrentAddReserveSett100,
        dPaidToDateOrig100Hold,
        dPaidToDateOrigShareHold,
        dPaidToDateSett100Hold,
        nClaimPaymentDays,
        dtClaimDueDate,
        dPaymentPendingTotalOrig100,
        dPaymentPendingTotalOrigShare,
        dPaymentPendingTotalSett100,
        dPaymentPendingTotalSettShare,
        b100PcEntered,
        bCoinsuranceClaimAccounting,
        dPaidThisTimeSett100Entered,
        dReviseAddReserveSett100,
        bAuthorisationResult,
        sAuthoriserNotes,
        bProductHardRuleResult,
        bProductRuleResult,
        lTypeOfModuleKey,
        lpolicylinekey,
        bisfirstmovement,
        bGenerateHistoryRow,
        bBureauClaim,
        lImplementationSetupForNewOldRIKey,
        bEnableNewRI,
        bRINonPropClaimAPRProc,
        bClaimMovementPaid,
        lPolicyFolderKey,
        lPolicyKey,
        lPolicyActivityKey,
        lPolicySectionKey,
        lPolSectionLiabilitySummaryKey,
        bLossDateTBA,
        lActivePolicyDetailsKey,
        lPolicyLiabilityKey,
        lPolicyLineLiabilityKey,
        bExGratiaPay,
        bClaimNotPaidWithinXS,
        dAmountClaimed,
        dtClaimsPaidDate,
        dtCoverageConfirmedDate,
        dtFeesPaidDate,
        bPolicySectionMandatory,
        bPolicyCoverageMandatory,
        bMovementBeingEdited,
        lRevTypeofMovementKey,
        bReveral,
        bReversed,
        lOrigClaimMovementKey,
        dReverseCurrentAddReserveSettShare,
        dReverseCurrentAddReserveOrig100,
        dReverseCurrentAddReserveOrigShare,
        dReverseCurrentAddReserveSett100,
        dReversePaidToDateSettShareHold,
        dReversePaidToDateOrig100Hold,
        dReversePaidToDateOrigShareHold,
        dReversePaidToDateSett100Hold,
        lrevtypeofmovementHistKey,
        lReinstatementCurrencyKey,
        dReinstatementROE,
        dReinstatementReserveTotal,
        dReinstatementReservePrevious,
        dReinstatementReserveChange,
        dReinstatementReserveRevise,
        dReinstatementReserveTotalReport,
        dReinstatementReservePreviousReport,
        dReinstatementReserveChangeReport,
        dReinstatementReserveReviseReport,
        dReinstatementPaidToDate,
        dReinstatementPaidToDatePrevious,
        dReinstatementPaidThisTime,
        dReinstatementPaidToDateReport,
        dReinstatementPaidToDatePreviousReport,
        dReinstatementPaidThisTimeReport,
        dReinstatementReserveCalculated,
        lPolicyAPRGroupKey,
        lvPolicyAPRGroupKey,
        dPaidThisTimeReportShare,
        lInwardsTypeOfDeductionKey,
        lInwardsDeductionCurrency,
        dInwardsDeductionROE,
        dInwardsDeductionAmount,
        lReinstatementTypeOfDeductionKey,
        lReinstatementDeductionCurrency,
        dReinstatementDeductionROE,
        dReinstatementDeductionAmount,
        dReviseAddReserveOrigShare,
        dPaidThisTimeBase,
        sClaimant,
        bAdjusted,
        bGenerateAPR,
        bGenerateJV,
        sBureauINsured,
        bTempAddReserve,
        nHighlight,
        dw_loadts,
        row_number() over (
            partition by
                lClaimMovementKey,
                lClaimSectionKey,
                lClaimKey,
                lAccountPeriodKey,
                lAccountPeriodOriginalKey,
                dtMovementFirstAdvised,
                dtMovementCreated,
                dtMovementUpdated,
                sMovementReference,
                nSequence,
                nBureauSequence,
                bManualMovement,
                bConverted,
                sPaymentReference,
                lTransactionTypeKey,
                lPayeeContactKey,
                lPayeeRoleKey,
                bReserveTBA,
                lTypeOfReserveQualifierKey,
                lTypeOfMovementKey,
                lPayMethodKey,
                lPayCcyOrigKey,
                dPayROEOrig,
                lPayCcySettKey,
                dPayROESett,
                lPayCcyReportKey,
                dPayROEReport,
                dPaidThisTimeOrig100,
                dPaidThisTimeOrigShare,
                dPaidThisTimeSett100,
                dPaidThisTimeSettShare,
                dPaymentOrig100,
                dPaymentOrigShare,
                dPaymentSett100,
                dPaymentSettShare,
                dPaymentAuthorisedOrig100,
                dPaymentAuthorisedOrigShare,
                dPaymentAuthorisedSett100,
                dPaymentAuthorisedSettShare,
                dPaymentPendingBureauOrig100,
                dPaymentPendingBureauOrigShare,
                dPaymentPendingBureauSett100,
                dPaymentPendingBureauSettShare,
                dPaymentPendingManualOrig100,
                dPaymentPendingManualOrigShare,
                dPaymentPendingManualSett100,
                dPaymentPendingManualSettShare,
                dFacRIPaidThisTimeOrigShare,
                dFacRIPaidThisTimeSettShare,
                dPropRIPaidThisTimeOrigShare,
                dPropRIPaidThisTimeSettShare,
                dXLRIPaidThisTimeOrigShare,
                dXLRIPaidThisTimeSettShare,
                dPaidToDateBureauOrig100,
                dPaidToDateBureauOrigShare,
                dPaidToDateBureauSett100,
                dPaidToDateBureauSettShare,
                dPaidToDateSettShareHold,
                dFacRIPaidToDateOrigShare,
                dFacRIPaidToDateSettShare,
                dPropRIPaidToDateOrigShare,
                dPropRIPaidToDateSettShare,
                dXLRIPaidToDateOrigShare,
                dXLRIPaidToDateSettShare,
                dNetPaidToDateOrigShare,
                dNetPaidToDateSettShare,
                lReserveCcyOrigKey,
                dReserveROEOrig,
                lReserveCcySettKey,
                dReserveROESett,
                lReserveCcyReportKey,
                dReserveROEReport,
                dReserveOrig100,
                dReserveOrigShare,
                dReserveSett100,
                dReserveSettShare,
                dReserveChangeOrig100,
                dReserveChangeOrigShare,
                dReserveChangeSett100,
                dReserveChangeSettShare,
                dReserveChangeAuthOrig100,
                dReserveChangeAuthOrigShare,
                dReserveChangeAuthSett100,
                dReserveChangeAuthSettShare,
                dFacRIReserveOrigShare,
                dFacRIReserveSettShare,
                dPropRIReserveOrigShare,
                dPropRIReserveSettShare,
                dXLRIReserveOrigShare,
                dXLRIReserveSettShare,
                dNetReserveOrigShare,
                dNetReserveSettShare,
                lAdditionalReserveCcyOrigKey,
                dAdditionalReserveROEOrig,
                lAdditionalReserveCcySettKey,
                dAdditionalReserveROESett,
                lAdditionalReserveCcyReportKey,
                dAdditionalReserveROEReport,
                dAdditionalReserveOrig100,
                dAdditionalReserveOrigShare,
                dAdditionalReserveSett100,
                dAdditionalReserveSettShare,
                dAdditionalFacRIOrigShare,
                dAdditionalFacRISettShare,
                dAdditionalPropRIOrigShare,
                dAdditionalPropRISettShare,
                dAdditionalXLRIOrigShare,
                dAdditionalXLRISettShare,
                dAdditionalNetReserveOrigShare,
                dAdditionalNetReserveSettShare,
                dReviseReserveOrig100,
                dReviseReserveOrigShare,
                dReviseReserveSett100,
                dReviseReserveSettShare,
                dTotalReserveOrig100,
                dTotalReserveOrigShare,
                dTotalReserveSett100,
                dTotalReserveSettShare,
                dTotalFacRIReserveOrigShare,
                dTotalFacRIReserveSettShare,
                dTotalPropRIReserveOrigShare,
                dTotalPropRIReserveSettShare,
                dTotalXLRIReserveOrigShare,
                dTotalXLRIReserveSettShare,
                dTotalNetReserveOrigShare,
                dTotalNetReserveSettShare,
                dHighestEstimateOrig100,
                dLeadUWHighestEstimateOrig100,
                sMovementNarrative,
                lExternalAdjusterContactKey,
                sExternalAdjusterReference,
                lExternalLawyerContactKey,
                sExternalLawyerReference,
                sClaimMovementCreatedBy,
                nAccidentYear,
                lAuthorityCheckJoinKey,
                lEventKey,
                bGenerateClaimException,
                lClaimantContactKey,
                sInvoiceNumber,
                lClaimMovementIndemnityKey,
                lClassKey,
                lTypeOfSubClassKey,
                lPayeeRoleKey2,
                lPayeeContactKey2,
                dRIRecoverySettShare,
                dOutstandingRIRecoverySettShr,
                dDeductibleSettShare,
                dLOCAmountSettShare,
                lInsuredKey,
                lExternalAttorneyContactKey,
                lISODeductibleSizeKey,
                lISOTexasDeductibleKey,
                sExtraPaymentDetails,
                bMultiplePayee,
                lBordereauMonthKey,
                bInError,
                sAddressedToName,
                sAddressTo1,
                sAddressTo2,
                sAddressToCity,
                sAddressToPostalCode,
                lAddressToStateKey,
                lAddressedToCountryKey,
                dCurrentAddReserveSettShare,
                dCalcAddReserveSettShare,
                dAddReserveChangeSettShare,
                dReviseAddReserveSettShare,
                dNetPaymentOrigShare,
                dNetPaymentSettShare,
                dPaidToDateOrig100,
                dPaidToDateOrigShare,
                dPaidToDateSett100,
                dPaidToDateSettShare,
                dPaidToDateManualOrig100,
                dPaidToDateManualOrigShare,
                dPaidToDateManualSett100,
                dPaidToDateManualSettShare,
                dAddReserveChangeOrig100,
                dAddReserveChangeOrigShare,
                dAddReserveChangeSett100,
                dTotalReserveChangeOrig100,
                dTotalReserveChangeOrigShare,
                dTotalReserveChangeSett100,
                dTotalReserveChangeSettShare,
                dAddResChangeAuthOrig100,
                dAddResChangeAuthOrigShare,
                dAddResChangeAuthSett100,
                dAddResChangeAuthSettShare,
                dTotalResChangeAuthOrig100,
                dTotalResChangeAuthOrigShare,
                dTotalResChangeAuthSett100,
                dTotalResChangeAuthSettShare,
                dCurrentAddReserveOrig100,
                dCurrentAddReserveOrigShare,
                dCurrentAddReserveSett100,
                dPaidToDateOrig100Hold,
                dPaidToDateOrigShareHold,
                dPaidToDateSett100Hold,
                nClaimPaymentDays,
                dtClaimDueDate,
                dPaymentPendingTotalOrig100,
                dPaymentPendingTotalOrigShare,
                dPaymentPendingTotalSett100,
                dPaymentPendingTotalSettShare,
                b100PcEntered,
                bCoinsuranceClaimAccounting,
                dPaidThisTimeSett100Entered,
                dReviseAddReserveSett100,
                bAuthorisationResult,
                sAuthoriserNotes,
                bProductHardRuleResult,
                bProductRuleResult,
                lTypeOfModuleKey,
                lpolicylinekey,
                bisfirstmovement,
                bGenerateHistoryRow,
                bBureauClaim,
                lImplementationSetupForNewOldRIKey,
                bEnableNewRI,
                bRINonPropClaimAPRProc,
                bClaimMovementPaid,
                lPolicyFolderKey,
                lPolicyKey,
                lPolicyActivityKey,
                lPolicySectionKey,
                lPolSectionLiabilitySummaryKey,
                bLossDateTBA,
                lActivePolicyDetailsKey,
                lPolicyLiabilityKey,
                lPolicyLineLiabilityKey,
                bExGratiaPay,
                bClaimNotPaidWithinXS,
                dAmountClaimed,
                dtClaimsPaidDate,
                dtCoverageConfirmedDate,
                dtFeesPaidDate,
                bPolicySectionMandatory,
                bPolicyCoverageMandatory,
                bMovementBeingEdited,
                lRevTypeofMovementKey,
                bReveral,
                bReversed,
                lOrigClaimMovementKey,
                dReverseCurrentAddReserveSettShare,
                dReverseCurrentAddReserveOrig100,
                dReverseCurrentAddReserveOrigShare,
                dReverseCurrentAddReserveSett100,
                dReversePaidToDateSettShareHold,
                dReversePaidToDateOrig100Hold,
                dReversePaidToDateOrigShareHold,
                dReversePaidToDateSett100Hold,
                lrevtypeofmovementHistKey,
                lReinstatementCurrencyKey,
                dReinstatementROE,
                dReinstatementReserveTotal,
                dReinstatementReservePrevious,
                dReinstatementReserveChange,
                dReinstatementReserveRevise,
                dReinstatementReserveTotalReport,
                dReinstatementReservePreviousReport,
                dReinstatementReserveChangeReport,
                dReinstatementReserveReviseReport,
                dReinstatementPaidToDate,
                dReinstatementPaidToDatePrevious,
                dReinstatementPaidThisTime,
                dReinstatementPaidToDateReport,
                dReinstatementPaidToDatePreviousReport,
                dReinstatementPaidThisTimeReport,
                dReinstatementReserveCalculated,
                lPolicyAPRGroupKey,
                lvPolicyAPRGroupKey,
                dPaidThisTimeReportShare,
                lInwardsTypeOfDeductionKey,
                lInwardsDeductionCurrency,
                dInwardsDeductionROE,
                dInwardsDeductionAmount,
                lReinstatementTypeOfDeductionKey,
                lReinstatementDeductionCurrency,
                dReinstatementDeductionROE,
                dReinstatementDeductionAmount,
                dReviseAddReserveOrigShare,
                dPaidThisTimeBase,
                sClaimant,
                bAdjusted,
                bGenerateAPR,
                bGenerateJV,
                sBureauINsured,
                bTempAddReserve,
                nHighlight
            order by
                dw_loadts
        ) as dw_extract_order
    from
        claim_movement
),

filtered as (
    select * from ordered where dw_extract_order = 1
),

ranged as (
    select
        lClaimMovementKey,
        lClaimSectionKey,
        lClaimKey,
        lAccountPeriodKey,
        lAccountPeriodOriginalKey,
        dtMovementFirstAdvised,
        dtMovementCreated,
        dtMovementUpdated,
        sMovementReference,
        nSequence,
        nBureauSequence,
        bManualMovement,
        bConverted,
        sPaymentReference,
        lTransactionTypeKey,
        lPayeeContactKey,
        lPayeeRoleKey,
        bReserveTBA,
        lTypeOfReserveQualifierKey,
        lTypeOfMovementKey,
        lPayMethodKey,
        lPayCcyOrigKey,
        dPayROEOrig,
        lPayCcySettKey,
        dPayROESett,
        lPayCcyReportKey,
        dPayROEReport,
        dPaidThisTimeOrig100,
        dPaidThisTimeOrigShare,
        dPaidThisTimeSett100,
        dPaidThisTimeSettShare,
        dPaymentOrig100,
        dPaymentOrigShare,
        dPaymentSett100,
        dPaymentSettShare,
        dPaymentAuthorisedOrig100,
        dPaymentAuthorisedOrigShare,
        dPaymentAuthorisedSett100,
        dPaymentAuthorisedSettShare,
        dPaymentPendingBureauOrig100,
        dPaymentPendingBureauOrigShare,
        dPaymentPendingBureauSett100,
        dPaymentPendingBureauSettShare,
        dPaymentPendingManualOrig100,
        dPaymentPendingManualOrigShare,
        dPaymentPendingManualSett100,
        dPaymentPendingManualSettShare,
        dFacRIPaidThisTimeOrigShare,
        dFacRIPaidThisTimeSettShare,
        dPropRIPaidThisTimeOrigShare,
        dPropRIPaidThisTimeSettShare,
        dXLRIPaidThisTimeOrigShare,
        dXLRIPaidThisTimeSettShare,
        dPaidToDateBureauOrig100,
        dPaidToDateBureauOrigShare,
        dPaidToDateBureauSett100,
        dPaidToDateBureauSettShare,
        dPaidToDateSettShareHold,
        dFacRIPaidToDateOrigShare,
        dFacRIPaidToDateSettShare,
        dPropRIPaidToDateOrigShare,
        dPropRIPaidToDateSettShare,
        dXLRIPaidToDateOrigShare,
        dXLRIPaidToDateSettShare,
        dNetPaidToDateOrigShare,
        dNetPaidToDateSettShare,
        lReserveCcyOrigKey,
        dReserveROEOrig,
        lReserveCcySettKey,
        dReserveROESett,
        lReserveCcyReportKey,
        dReserveROEReport,
        dReserveOrig100,
        dReserveOrigShare,
        dReserveSett100,
        dReserveSettShare,
        dReserveChangeOrig100,
        dReserveChangeOrigShare,
        dReserveChangeSett100,
        dReserveChangeSettShare,
        dReserveChangeAuthOrig100,
        dReserveChangeAuthOrigShare,
        dReserveChangeAuthSett100,
        dReserveChangeAuthSettShare,
        dFacRIReserveOrigShare,
        dFacRIReserveSettShare,
        dPropRIReserveOrigShare,
        dPropRIReserveSettShare,
        dXLRIReserveOrigShare,
        dXLRIReserveSettShare,
        dNetReserveOrigShare,
        dNetReserveSettShare,
        lAdditionalReserveCcyOrigKey,
        dAdditionalReserveROEOrig,
        lAdditionalReserveCcySettKey,
        dAdditionalReserveROESett,
        lAdditionalReserveCcyReportKey,
        dAdditionalReserveROEReport,
        dAdditionalReserveOrig100,
        dAdditionalReserveOrigShare,
        dAdditionalReserveSett100,
        dAdditionalReserveSettShare,
        dAdditionalFacRIOrigShare,
        dAdditionalFacRISettShare,
        dAdditionalPropRIOrigShare,
        dAdditionalPropRISettShare,
        dAdditionalXLRIOrigShare,
        dAdditionalXLRISettShare,
        dAdditionalNetReserveOrigShare,
        dAdditionalNetReserveSettShare,
        dReviseReserveOrig100,
        dReviseReserveOrigShare,
        dReviseReserveSett100,
        dReviseReserveSettShare,
        dTotalReserveOrig100,
        dTotalReserveOrigShare,
        dTotalReserveSett100,
        dTotalReserveSettShare,
        dTotalFacRIReserveOrigShare,
        dTotalFacRIReserveSettShare,
        dTotalPropRIReserveOrigShare,
        dTotalPropRIReserveSettShare,
        dTotalXLRIReserveOrigShare,
        dTotalXLRIReserveSettShare,
        dTotalNetReserveOrigShare,
        dTotalNetReserveSettShare,
        dHighestEstimateOrig100,
        dLeadUWHighestEstimateOrig100,
        sMovementNarrative,
        lExternalAdjusterContactKey,
        sExternalAdjusterReference,
        lExternalLawyerContactKey,
        sExternalLawyerReference,
        sClaimMovementCreatedBy,
        nAccidentYear,
        lAuthorityCheckJoinKey,
        lEventKey,
        bGenerateClaimException,
        lClaimantContactKey,
        sInvoiceNumber,
        lClaimMovementIndemnityKey,
        lClassKey,
        lTypeOfSubClassKey,
        lPayeeRoleKey2,
        lPayeeContactKey2,
        dRIRecoverySettShare,
        dOutstandingRIRecoverySettShr,
        dDeductibleSettShare,
        dLOCAmountSettShare,
        lInsuredKey,
        lExternalAttorneyContactKey,
        lISODeductibleSizeKey,
        lISOTexasDeductibleKey,
        sExtraPaymentDetails,
        bMultiplePayee,
        lBordereauMonthKey,
        bInError,
        sAddressedToName,
        sAddressTo1,
        sAddressTo2,
        sAddressToCity,
        sAddressToPostalCode,
        lAddressToStateKey,
        lAddressedToCountryKey,
        dCurrentAddReserveSettShare,
        dCalcAddReserveSettShare,
        dAddReserveChangeSettShare,
        dReviseAddReserveSettShare,
        dNetPaymentOrigShare,
        dNetPaymentSettShare,
        dPaidToDateOrig100,
        dPaidToDateOrigShare,
        dPaidToDateSett100,
        dPaidToDateSettShare,
        dPaidToDateManualOrig100,
        dPaidToDateManualOrigShare,
        dPaidToDateManualSett100,
        dPaidToDateManualSettShare,
        dAddReserveChangeOrig100,
        dAddReserveChangeOrigShare,
        dAddReserveChangeSett100,
        dTotalReserveChangeOrig100,
        dTotalReserveChangeOrigShare,
        dTotalReserveChangeSett100,
        dTotalReserveChangeSettShare,
        dAddResChangeAuthOrig100,
        dAddResChangeAuthOrigShare,
        dAddResChangeAuthSett100,
        dAddResChangeAuthSettShare,
        dTotalResChangeAuthOrig100,
        dTotalResChangeAuthOrigShare,
        dTotalResChangeAuthSett100,
        dTotalResChangeAuthSettShare,
        dCurrentAddReserveOrig100,
        dCurrentAddReserveOrigShare,
        dCurrentAddReserveSett100,
        dPaidToDateOrig100Hold,
        dPaidToDateOrigShareHold,
        dPaidToDateSett100Hold,
        nClaimPaymentDays,
        dtClaimDueDate,
        dPaymentPendingTotalOrig100,
        dPaymentPendingTotalOrigShare,
        dPaymentPendingTotalSett100,
        dPaymentPendingTotalSettShare,
        b100PcEntered,
        bCoinsuranceClaimAccounting,
        dPaidThisTimeSett100Entered,
        dReviseAddReserveSett100,
        bAuthorisationResult,
        sAuthoriserNotes,
        bProductHardRuleResult,
        bProductRuleResult,
        lTypeOfModuleKey,
        lpolicylinekey,
        bisfirstmovement,
        bGenerateHistoryRow,
        bBureauClaim,
        lImplementationSetupForNewOldRIKey,
        bEnableNewRI,
        bRINonPropClaimAPRProc,
        bClaimMovementPaid,
        lPolicyFolderKey,
        lPolicyKey,
        lPolicyActivityKey,
        lPolicySectionKey,
        lPolSectionLiabilitySummaryKey,
        bLossDateTBA,
        lActivePolicyDetailsKey,
        lPolicyLiabilityKey,
        lPolicyLineLiabilityKey,
        bExGratiaPay,
        bClaimNotPaidWithinXS,
        dAmountClaimed,
        dtClaimsPaidDate,
        dtCoverageConfirmedDate,
        dtFeesPaidDate,
        bPolicySectionMandatory,
        bPolicyCoverageMandatory,
        bMovementBeingEdited,
        lRevTypeofMovementKey,
        bReveral,
        bReversed,
        lOrigClaimMovementKey,
        dReverseCurrentAddReserveSettShare,
        dReverseCurrentAddReserveOrig100,
        dReverseCurrentAddReserveOrigShare,
        dReverseCurrentAddReserveSett100,
        dReversePaidToDateSettShareHold,
        dReversePaidToDateOrig100Hold,
        dReversePaidToDateOrigShareHold,
        dReversePaidToDateSett100Hold,
        lrevtypeofmovementHistKey,
        lReinstatementCurrencyKey,
        dReinstatementROE,
        dReinstatementReserveTotal,
        dReinstatementReservePrevious,
        dReinstatementReserveChange,
        dReinstatementReserveRevise,
        dReinstatementReserveTotalReport,
        dReinstatementReservePreviousReport,
        dReinstatementReserveChangeReport,
        dReinstatementReserveReviseReport,
        dReinstatementPaidToDate,
        dReinstatementPaidToDatePrevious,
        dReinstatementPaidThisTime,
        dReinstatementPaidToDateReport,
        dReinstatementPaidToDatePreviousReport,
        dReinstatementPaidThisTimeReport,
        dReinstatementReserveCalculated,
        lPolicyAPRGroupKey,
        lvPolicyAPRGroupKey,
        dPaidThisTimeReportShare,
        lInwardsTypeOfDeductionKey,
        lInwardsDeductionCurrency,
        dInwardsDeductionROE,
        dInwardsDeductionAmount,
        lReinstatementTypeOfDeductionKey,
        lReinstatementDeductionCurrency,
        dReinstatementDeductionROE,
        dReinstatementDeductionAmount,
        dReviseAddReserveOrigShare,
        dPaidThisTimeBase,
        sClaimant,
        bAdjusted,
        bGenerateAPR,
        bGenerateJV,
        sBureauINsured,
        bTempAddReserve,
        nHighlight,
        dw_loadts as _valid_from,
        lead(dw_loadts) over (partition by lClaimMovementKey order by dw_loadts) as _valid_to
    from
        filtered
)

select * from ranged
