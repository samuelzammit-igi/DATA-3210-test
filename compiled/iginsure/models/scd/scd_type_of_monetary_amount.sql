-- This file is automatically generated


with

type_of_monetary_amount as (
    select * from "IGI_PROD_DW"."dbo"."TypeOfMonetaryAmount"
),

ordered as (
    select
        lTypeOfMonetaryAmountKey,
        sCode,
        sTypeOfMonetaryAmount,
        sTypeOfMonetaryAmountSearch,
        nSequenceWithinSection,
        lTypeOfMonetarySectionKey,
        nLPCItemNumber,
        bPostToSummaryValues,
        bGroupForSummaryValues,
        lTypeOfDeductionKey,
        bAvailableForTA,
        bmoneyin,
        bCalculatedUPR,
        bcalculatedDAC,
        lDirectDebitChartOfActKey,
        lDirectCreditChartOfActKey,
        lIndirectDebitChartOfActkey,
        lIndirectCreditChartOfActkey,
        bPipelineApplies,
        lDirectPLCreditChartOfActKey,
        lDirectPLDebitChartOfActKey,
        lIndirectPLCreditChartOfactKey,
        lIndirectPLDebitChartOfactKey,
        bAvailableForManual,
        bGrossValue,
        bNetValue,
        bdeduction,
        nExpectedSign,
        sLongCode2,
        lTypeOfTechnicalCategorykey,
        bAddition,
        bBrokerDeductible,
        bPayaway,
        bPassedToInsured,
        bIsAcquisitionCost,
        bDiscount,
        lTypeOfDeductionPayableKey,
        lDeductionApplicableToKey,
        lPassThroughLinkKey,
        bReduceGrossPremium,
        lTypeOfCodeSetKey,
        bAvailableForCash,
        nCashMatchingOrder,
        bAvailableForAllocation,
        bAvailableInAccSub,
        lTypeOfMonetaryAmountGroupKey,
        nMAGroupParentOrder,
        bTaxDefaultExcludeable,
        bPassThroughPremium,
        bTax,
        bDontCreateAPR,
        lTypeOfGrossNetDeductionKey,
        bGrossNetLocked,
        bInwardsDeduction,
        bOutwardsDeduction,
        bIncludeInMatching,
        bDataMigrationOnly,
        bRIAddition,
        bDoNotCede,
        bDoNotCedeOutwardFAC,
        dw_loadts,
        row_number() over (
            partition by
                lTypeOfMonetaryAmountKey,
                sCode,
                sTypeOfMonetaryAmount,
                sTypeOfMonetaryAmountSearch,
                nSequenceWithinSection,
                lTypeOfMonetarySectionKey,
                nLPCItemNumber,
                bPostToSummaryValues,
                bGroupForSummaryValues,
                lTypeOfDeductionKey,
                bAvailableForTA,
                bmoneyin,
                bCalculatedUPR,
                bcalculatedDAC,
                lDirectDebitChartOfActKey,
                lDirectCreditChartOfActKey,
                lIndirectDebitChartOfActkey,
                lIndirectCreditChartOfActkey,
                bPipelineApplies,
                lDirectPLCreditChartOfActKey,
                lDirectPLDebitChartOfActKey,
                lIndirectPLCreditChartOfactKey,
                lIndirectPLDebitChartOfactKey,
                bAvailableForManual,
                bGrossValue,
                bNetValue,
                bdeduction,
                nExpectedSign,
                sLongCode2,
                lTypeOfTechnicalCategorykey,
                bAddition,
                bBrokerDeductible,
                bPayaway,
                bPassedToInsured,
                bIsAcquisitionCost,
                bDiscount,
                lTypeOfDeductionPayableKey,
                lDeductionApplicableToKey,
                lPassThroughLinkKey,
                bReduceGrossPremium,
                lTypeOfCodeSetKey,
                bAvailableForCash,
                nCashMatchingOrder,
                bAvailableForAllocation,
                bAvailableInAccSub,
                lTypeOfMonetaryAmountGroupKey,
                nMAGroupParentOrder,
                bTaxDefaultExcludeable,
                bPassThroughPremium,
                bTax,
                bDontCreateAPR,
                lTypeOfGrossNetDeductionKey,
                bGrossNetLocked,
                bInwardsDeduction,
                bOutwardsDeduction,
                bIncludeInMatching,
                bDataMigrationOnly,
                bRIAddition,
                bDoNotCede,
                bDoNotCedeOutwardFAC
            order by
                dw_loadts
        ) as dw_extract_order
    from
        type_of_monetary_amount
),

filtered as (
    select * from ordered where dw_extract_order = 1
),

ranged as (
    select
        lTypeOfMonetaryAmountKey,
        sCode,
        sTypeOfMonetaryAmount,
        sTypeOfMonetaryAmountSearch,
        nSequenceWithinSection,
        lTypeOfMonetarySectionKey,
        nLPCItemNumber,
        bPostToSummaryValues,
        bGroupForSummaryValues,
        lTypeOfDeductionKey,
        bAvailableForTA,
        bmoneyin,
        bCalculatedUPR,
        bcalculatedDAC,
        lDirectDebitChartOfActKey,
        lDirectCreditChartOfActKey,
        lIndirectDebitChartOfActkey,
        lIndirectCreditChartOfActkey,
        bPipelineApplies,
        lDirectPLCreditChartOfActKey,
        lDirectPLDebitChartOfActKey,
        lIndirectPLCreditChartOfactKey,
        lIndirectPLDebitChartOfactKey,
        bAvailableForManual,
        bGrossValue,
        bNetValue,
        bdeduction,
        nExpectedSign,
        sLongCode2,
        lTypeOfTechnicalCategorykey,
        bAddition,
        bBrokerDeductible,
        bPayaway,
        bPassedToInsured,
        bIsAcquisitionCost,
        bDiscount,
        lTypeOfDeductionPayableKey,
        lDeductionApplicableToKey,
        lPassThroughLinkKey,
        bReduceGrossPremium,
        lTypeOfCodeSetKey,
        bAvailableForCash,
        nCashMatchingOrder,
        bAvailableForAllocation,
        bAvailableInAccSub,
        lTypeOfMonetaryAmountGroupKey,
        nMAGroupParentOrder,
        bTaxDefaultExcludeable,
        bPassThroughPremium,
        bTax,
        bDontCreateAPR,
        lTypeOfGrossNetDeductionKey,
        bGrossNetLocked,
        bInwardsDeduction,
        bOutwardsDeduction,
        bIncludeInMatching,
        bDataMigrationOnly,
        bRIAddition,
        bDoNotCede,
        bDoNotCedeOutwardFAC,
        dw_loadts as _valid_from,
        lead(dw_loadts) over (partition by lTypeOfMonetaryAmountKey order by dw_loadts) as _valid_to
    from
        filtered
)

select * from ranged